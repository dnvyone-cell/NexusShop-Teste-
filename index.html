<!DOCTYPE html>
<html lang="pt-PT">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nexus Admin Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
</head>
<body class="bg-zinc-950 text-white min-h-screen flex items-center justify-center p-6">

    <div class="bg-zinc-900 border border-zinc-800 p-8 rounded-3xl w-full max-w-lg shadow-2xl">
        <h1 class="text-3xl font-black mb-6 text-blue-500 tracking-tight">Nexus Uploader</h1>
        
        <form id="uploadForm" class="space-y-4">
            <div>
                <label class="block text-xs font-bold text-zinc-500 uppercase mb-1">Nome do App</label>
                <input type="text" id="appName" class="w-full bg-black border border-zinc-800 rounded-xl p-3 text-sm outline-none focus:border-blue-500 transition-colors" required>
            </div>

            <div>
                <label class="block text-xs font-bold text-zinc-500 uppercase mb-1">Desenvolvedor</label>
                <input type="text" id="appDev" class="w-full bg-black border border-zinc-800 rounded-xl p-3 text-sm outline-none focus:border-blue-500 transition-colors" required>
            </div>

            <div>
                <label class="block text-xs font-bold text-zinc-500 uppercase mb-1">URL do Ícone</label>
                <input type="url" id="appIcon" class="w-full bg-black border border-zinc-800 rounded-xl p-3 text-sm outline-none focus:border-blue-500 transition-colors" required>
            </div>

            <div>
                <label class="block text-xs font-bold text-zinc-500 uppercase mb-1">URL de Download</label>
                <input type="url" id="appDownload" class="w-full bg-black border border-zinc-800 rounded-xl p-3 text-sm outline-none focus:border-blue-500 transition-colors" required>
            </div>

            <div>
                <label class="block text-xs font-bold text-zinc-500 uppercase mb-1">Categoria</label>
                <select id="appCategory" class="w-full bg-black border border-zinc-800 rounded-xl p-3 text-sm outline-none focus:border-blue-500 text-white">
                    <option value="Apps">Apps</option>
                    <option value="Jogos">Jogos</option>
                    <option value="Utilitários">Utilitários</option>
                </select>
            </div>

            <button type="submit" class="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-4 rounded-xl shadow-lg transition-all active:scale-95 mt-4">
                Publicar na Loja
            </button>
        </form>
    </div>

    <script>
        // Mesma configuração da sua loja principal
        const firebaseConfig = {
            apiKey: "AIzaSyDcWSyP6S7LDuGQ1ZjFqKAHCZ8mjwJhEKY",
            authDomain: "nexus-hub-159db.firebaseapp.com",
            projectId: "nexus-hub-159db",
            storageBucket: "nexus-hub-159db.firebasestorage.app",
            messagingSenderId: "400199878551",
            appId: "1:400199878551:web:4f58353584daffbeb026d2"
        };

        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const db = firebase.firestore();
        const DB_APP_ID = 'nexus-hub-permanent-vault';

        document.getElementById('uploadForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = e.target.querySelector('button');
            btn.innerText = "Publicando...";
            btn.disabled = true;

            // Monta o objeto no mesmo formato que a sua loja espera
            const newApp = {
                name: document.getElementById('appName').value,
                developer: document.getElementById('appDev').value,
                icon: document.getElementById('appIcon').value,
                downloadUrl: document.getElementById('appDownload').value,
                category: document.getElementById('appCategory').value,
                platform: 'Mobile',
                version: '1.0',
                rating: '5.0',
                isMod: false,
                description: 'App adicionado via Painel Admin.',
                screenshots: [],
                lastUpdated: Date.now()
            };

            try {
                // Salva diretamente na coleção de apps da Nexus Store
                await db.collection('artifacts')
                        .doc(DB_APP_ID)
                        .collection('public')
                        .doc('data')
                        .collection('apps')
                        .add(newApp);
                
                alert("App publicado com sucesso!");
                e.target.reset(); // Limpa o formulário
            } catch (error) {
                console.error("Erro ao publicar:", error);
                alert("Erro ao publicar: " + error.message);
            } finally {
                btn.innerText = "Publicar na Loja";
                btn.disabled = false;
            }
        });
    </script>
</body>
</html>
